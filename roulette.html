<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–†—É–ª–µ—Ç–∫–∞ –ø—Ä–∏–∑–æ–≤ ‚Äî –û–ü–ü–û –ê–ì–£</title>
<link rel="stylesheet" href="./styles.css">
</head>
<body>
  <header class="nav">
    <nav>
      <a class="btn" href="./index.html">–ì–ª–∞–≤–Ω–∞—è</a>
    </nav>
  </header>

  <main class="container">
    <section class="section">
      <h1 style="margin:0 0 10px">–†—É–ª–µ—Ç–∫–∞ –ø—Ä–∏–∑–æ–≤</h1>
    </section>

   <section class="wheel-wrap">
  <div class="wheel-box">
    <div class="pointer" aria-hidden="true"></div>
    <div class="wheel" id="wheel" aria-label="–ò–≥—Ä–æ–≤–∞—è —Ä—É–ª–µ—Ç–∫–∞">
      <button class="wheel-center" id="spinBtn" type="button">SPIN</button>
    </div>
  </div>

  <div class="result" id="result" role="status" aria-live="polite"></div>
  <div style="display:flex; gap:10px; margin-top:10px">
    <button class="btn" id="resetBtn">–°–±—Ä–æ—Å</button>
  </div>
</section>

  </main>

  <footer class="container">
    ¬© {year} –û–ü–ü–û –ê–ì–£
  </footer>
<script>
(function(){
  const wheel = document.getElementById('wheel');
  const result = document.getElementById('result');
  const spinBtn = document.getElementById('spinBtn');
  const resetBtn = document.getElementById('resetBtn');

  let spinning = false;
  let lastRotation = 0; // —Ç–µ–∫—É—â–∏–π —É–≥–æ–ª (–Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ–º, –Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º)

  const rand = (min, max) => Math.random() * (max - min) + min;

  function spin(){
    if (spinning) return;
    spinning = true;
    result.textContent = "";

    // 10% —à–∞–Ω—Å –≤—ã–∏–≥—Ä—ã—à–∞
    const win = Math.random() < 0.10;

    // –í—ã–∏–≥—Ä—ã—à–Ω—ã–π —Å–µ–∫—Ç–æ—Ä: 0..36¬∞ (—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞–≤–µ—Ä—Ö—É).
    // –ß—É—Ç—å —É—Ö–æ–¥–∏–º –æ—Ç –≥—Ä–∞–Ω–∏—Ü, —á—Ç–æ–±—ã –Ω–µ –ª–æ–≤–∏—Ç—å –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –Ω–∞ —Å—Ç—ã–∫–µ.
    const eps = 0.4;
    let targetAngle = win ? rand(eps, 36 - eps) : rand(40, 360 - eps);

    // –ö—Ä–∞—Å–∏–≤–æ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–æ—Ä–æ—Ç–æ–≤
    const baseSpins = 6;
    const finalRotation = baseSpins * 360 + targetAngle;

    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ—à–ª—ã–π —É–≥–æ–ª, —á—Ç–æ–±—ã –Ω–µ —Ä–æ—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    lastRotation = (lastRotation % 360) + finalRotation;

    wheel.style.transition = "transform 4s cubic-bezier(.22,.61,.36,1)";
    wheel.style.transform = `rotate(${lastRotation}deg)`;

    setTimeout(() => {
      result.textContent = win ? "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ü—Ä–∏–∑ –≤–∞—à üéâ" : "–ü–æ–≤–µ–∑—ë—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑.";
      spinning = false;
    }, 4100);
  }

  function reset(){
    if (spinning) return;
    lastRotation = 0;
    wheel.style.transition = "none";
    wheel.style.transform = "rotate(0deg)";
    // —Ñ–æ—Ä—Å–∏–º –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –∏–Ω–µ—Ä—Ü–∏—é transition
    void wheel.offsetWidth;
    result.textContent = "";
  }

  // —Ü–µ–Ω—Ç—Ä –°–ü–ò–ù —Ç–æ–∂–µ –∫–Ω–æ–ø–∫–∞
  spinBtn.addEventListener('click', spin);
  resetBtn.addEventListener('click', reset);

  // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ–¥ –≤ —Ñ—É—Ç–µ—Ä–µ
  document.querySelector('footer').innerHTML =
    document.querySelector('footer').innerHTML.replace('{year}', new Date().getFullYear());

  // –£–≤–∞–∂–µ–Ω–∏–µ prefers-reduced-motion
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches){
    wheel.style.transition = "transform .8s linear";
  }
})();
</script>

</body>
</html>
